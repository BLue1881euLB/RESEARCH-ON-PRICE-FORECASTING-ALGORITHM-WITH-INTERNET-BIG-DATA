sz=[3.59	3.69	3.55	3.68
3.7	3.73	3.64	3.65
3.68	3.68	3.63	3.65
3.65	3.72	3.57	3.6
3.57	3.6	3.51	3.55
3.59	3.65	3.54	3.56
3.57	3.62	3.45	3.46
3.48	3.52	3.38	3.41
3.47	3.48	3.34	3.37
3.36	3.53	3.36	3.5
3.45	3.54	3.44	3.48
3.47	3.47	3.37	3.38
3.37	3.44	3.35	3.43
3.42	3.5	3.42	3.46
3.52	3.52	3.38	3.39
3.39	3.46	3.39	3.45
3.47	3.59	3.41	3.56
3.6	3.61	3.52	3.58
3.53	3.6	3.49	3.5
3.48	3.49	3.38	3.38
3.45	3.45	3.27	3.39
3.37	3.42	3.36	3.41
3.36	3.39	3.28	3.33
3.34	3.39	3.1	3.22
3.22	3.28	3.07	3.09
3	3	2.38	2.87
2.85	3.07	2.76	3.03
3.02	3.19	3	3.09
2.99	3.2	2.99	3.17
3.2	3.21	3.13	3.17
3.17	3.18	3.1	3.13
3.13	3.22	3.08	3.18
3.23	3.25	3.18	3.21
3.21	3.27	3.2	3.22
3.25	3.25	3.15	3.21
3.16	3.21	3.15	3.19
3.2	3.2	3.13	3.16
3.12	3.15	3.11	3.13
3.11	3.11	3	3.03
2.98	3.1	2.98	3.01
3.03	3.07	3	3.01
3.07	3.09	3	3.04
3.08	3.08	2.99	3.04
3.05	3.07	2.98	3.01
2.97	3.05	2.97	3.02
2.99	3.05	2.99	3.01
3.03	3.03	2.98	3
2.96	3.05	2.96	3
3.03	3.07	2.99	3.06
3.08	3.15	3.03	3.04
3.01	3.03	2.85	2.94
2.92	2.97	2.88	2.93
2.97	2.97	2.91	2.94
2.96	2.96	2.89	2.92
2.95	2.96	2.88	2.9
2.88	2.94	2.84	2.91
2.93	2.94	2.84	2.86
2.83	2.87	2.75	2.79
2.7	2.7	2.61	2.65
2.52	2.73	2.52	2.62
2.6	2.66	2.55	2.56
2.63	2.73	2.63	2.71
2.77	2.88	2.76	2.81
2.8	2.8	2.69	2.72
2.73	2.75	2.66	2.69
2.6	2.68	2.52	2.64
2.61	2.67	2.57	2.58
2.55	2.65	2.55	2.6
2.59	2.71	2.59	2.69
2.71	2.79	2.7	2.73
2.68	2.73	2.64	2.72
2.75	2.78	2.72	2.75
2.77	2.79	2.72	2.74
2.73	2.76	2.7	2.71
2.72	2.76	2.69	2.73
2.75	2.78	2.73	2.75
2.67	2.74	2.66	2.69
2.64	2.73	2.64	2.72
2.74	2.82	2.74	2.77
2.76	2.76	2.68	2.71
2.73	2.73	2.69	2.71
2.69	2.72	2.66	2.7
2.65	2.69	2.61	2.69
2.73	2.79	2.68	2.79
2.85	2.94	2.84	2.85
2.88	2.92	2.84	2.87
2.9	2.9	2.8	2.84
2.85	2.92	2.84	2.92
2.91	2.94	2.87	2.91
2.97	3.01	2.92	2.95
3.02	3.06	2.98	3.02
3.04	3.05	2.98	2.99
2.99	2.99	2.94	2.97
2.94	3.01	2.94	2.98
3.04	3.07	3	3.04
3.06	3.08	3.03	3.07
3.04	3.06	3	3.04
3.01	3.05	2.98	3
3.05	3.06	3.02	3.05
3.14	3.14	3.07	3.1
3.08	3.09	2.99	3.05
3.02	3.05	2.99	3.02
3.03	3.03	2.96	2.97
2.98	3	2.94	2.96
2.96	3.03	2.92	2.94
2.96	2.99	2.93	2.97
2.97	3.03	2.97	3.02
3.04	3.07	2.99	3.07
3.1	3.1	3.02	3.03
3.07	3.07	3	3.01
2.98	3	2.93	2.93
2.93	2.95	2.91	2.91
2.96	2.99	2.91	2.94
2.94	2.94	2.85	2.91
2.83	2.9	2.83	2.89
2.93	2.97	2.9	2.91
2.94	3.02	2.88	2.94
2.97	3.04	2.96	3.01
3.03	3.03	2.96	3.02
3.03	3.04	2.99	3.02
3	3.03	2.98	3.03
3	3	2.93	2.96
2.98	2.99	2.9	2.92
2.91	2.94	2.87	2.89
2.9	2.92	2.85	2.91
2.88	3.07	2.86	3.07
3.07	3.17	3.04	3.1
3.07	3.13	3.07	3.13
3.03	3.13	3.03	3.1
3.1	3.15	3.05	3.09
3.02	3.07	3	3.04
3.01	3.07	3	3.03
3.03	3.08	3	3.02
3.02	3.02	2.85	2.88
2.82	2.9	2.8	2.89
2.9	2.98	2.89	2.95
2.97	3.07	2.96	3.07
3.08	3.15	3.05	3.1
3.05	3.09	3.02	3.08
3.08	3.12	3.05	3.1
3.15	3.15	3.08	3.1
3.12	3.12	3.09	3.12
3.14	3.14	3.07	3.12
3.12	3.15	3.1	3.11
3.12	3.15	3.07	3.13
3.1	3.14	3.1	3.12
3.14	3.18	3.1	3.18
3.19	3.2	3.02	3.04
3.08	3.17	3.04	3.06
3.05	3.11	3.03	3.11
3.06	3.09	2.9	2.97
2.97	3.11	2.93	3.05
2.93	3.03	2.93	3.01
3.06	3.08	2.98	3
3.02	3.04	2.98	2.98
2.95	3.03	2.95	3.02
3	3.02	2.95	2.95
2.9	2.94	2.85	2.93
2.96	3.02	2.93	3
2.96	2.97	2.87	2.96
2.91	2.98	2.81	2.87
2.92	3.03	2.85	2.99
3.02	3.02	2.94	2.99
2.98	2.98	2.9	2.91
2.98	2.99	2.9	2.91
2.93	2.94	2.9	2.94
2.92	3	2.9	2.98
3	3.01	2.96	3
2.99	3.01	2.95	3
3.02	3.03	2.92	2.97
2.98	3	2.96	2.99
3.03	3.03	2.98	3
3	3	2.91	2.94
2.9	2.93	2.9	2.92
2.98	2.99	2.92	2.96
2.99	3.03	2.96	2.99
3.03	3.03	2.93	2.97
3	3.02	2.96	2.97
2.97	3	2.94	2.98
2.98	3.03	2.97	2.99
3	3	2.91	2.98
2.94	2.96	2.94	2.95
2.94	2.95	2.83	2.85
2.92	2.94	2.87	2.89
2.93	2.93	2.83	2.83
2.84	2.92	2.83	2.91
2.96	3.09	2.93	3.08
3.08	3.18	3.08	3.15
3.15	3.17	3.11	3.14
3.17	3.29	3.17	3.29
3.26	3.3	3.2	3.3
3.3	3.3	3.23	3.3
3.3	3.35	3.26	3.27
3.28	3.37	3.27	3.37
3.4	3.52	3.39	3.52
3.45	3.48	3.2	3.2
3.22	3.22	2.99	3.01
3.03	3.08	3.01	3.04
3.07	3.12	3.03	3.1
3.06	3.1	3.02	3.05
3.08	3.08	3.03	3.04
3.03	3.06	3.01	3.04
3.05	3.05	2.99	3
2.98	3.07	2.98	3.05
3.08	3.08	3.02	3.07
3.03	3.1	3.03	3.08
3.06	3.06	3	3.03
3.01	3.04	2.99	2.99
3	3.02	2.99	3
3	3.05	3	3.04
3.02	3.11	3	3.1
3.08	3.14	3.05	3.12
3.14	3.14	3.07	3.1
3.14	3.15	3.12	3.15
3.15	3.16	3.12	3.13
3.15	3.16	3.05	3.13
3.16	3.16	3.08	3.15
3.18	3.18	3.13	3.15
3.13	3.17	3.09	3.14
3.15	3.17	3.13	3.16
3.14	3.17	3.12	3.16
3.17	3.17	3.11	3.13
3.11	3.14	3.08	3.11
3.12	3.12	3.08	3.09
3.11	3.13	3.07	3.1
3.11	3.11	3.05	3.07
3.09	3.11	3.06	3.1
3.1	3.14	3.07	3.14
3.1	3.14	3.08	3.14
3.14	3.14	3.08	3.11
3.08	3.13	3.08	3.08
3.07	3.08	3.04	3.06
3.06	3.09	3.05	3.06
3.07	3.08	3.01	3.07
3.07	3.07	2.97	3.01
3	3.01	2.99	3
3.02	3.02	2.97	3.01
2.97	3.02	2.97	3.01
2.97	3	2.96	2.97
2.95	3	2.95	2.99
3	3.03	2.96	3
3	3.01	2.99	3.01
3	3.03	2.98	3.01
3.03	3.08	3.01	3.07
3.08	3.14	3.07	3.12
3.13	3.15	3.11	3.14
3.13	3.15	3.1	3.11
3.1	3.11	3.03	3.1
3.1	3.1	3.07	3.09
3.09	3.13	3.06	3.08
3.09	3.11	3.07	3.09
3.13	3.13	3.08	3.1]
[m,n]=size(sz);
ts = sz(2:m,4);
tsx=sz(1:m-1,:);
%shuju gui 1hua
TS= ts';
TSX=tsx';
%dui ts gui 1 hua
[Pn1,minp1,maxp1]=premnmx(TS)
[Pn2,minp2,maxp2]=premnmx(TSX)

rand('state',0);
%PR=[-1,1;-1,1;-1,1;-1,1;-1,1];
PR=[-1,1;-1,1;-1,1;-1,1];
net = newff(PR,[80,1],{'tansig','purelin'},'traingdx','learngdm','mse')
net.trainparam.show = 50;
net.trainparam.lr =0.1;
net.trainparam.mc=0.9;
net.trainparam.epochs=10000;
net=init(net);
% net=train(net,Pn2(:,1:40),Pn1(1:40));%chuangjian wangluo
% %fangzhen
% test = Pn2(:,31:end);
net=train(net,Pn2(:,1:240),Pn1(1:240));%chuangjian wangluo 252-240
%fangzhen
% test = Pn2(:,31:end);
test = Pn2(:,230:end);%252-230
Y=sim(net,test)
%fang gui1 hua
P=postmnmx(Y,minp1,maxp1)
%xiang dui wu cha 
e = (sz(231:m)-P)./sz(231:m)
res = norm(e)

% huachu kaipan
figure(1)
% t = 32:m
t = 231:m
% plot(t',sz(32:m),'-+',t,P,'o')
plot(t',sz(231:m),'-+',t,P,'o')
legend('真实值','预测值')
xlabel('时间(days)')
ylabel('收盘价(元)')


